
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
  password String
  name String?
  createdAt DateTime @default(now())

  favorites Favorite[]
  
}

model Favorite {
  id String @id @default(auto()) @map("_id") @db.ObjectId
  userId String @db.ObjectId
  user User @relation(fields: [userId], references: [id])

  cafeId String @db.ObjectId
  cafe Cafe @relation(fields: [cafeId], references: [id]) 

  createdAt DateTime @default(now())
}

// 定義座標的複合型別 (適合 MongoDB)

model Cafe {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  googlePlaceId String   @unique

  // --- Google Maps API 欄位 ---
  displayName      String   // 店名
  formattedAddress String   // 完整地址
  businessStatus   BusinessStatus  // 營業狀態 (例如: OPERATIONAL)
  location         Location // 經緯度座標

  // --- 核心連接性 ---
  hasWifi         Boolean? // 是否有提供 Wi-Fi
  hasPowerOutlets Boolean?   // 是否有提供插座
  outletCoverage  OutletCoverage?  // 插座覆蓋率

  // --- 環境氛圍 ---
  seatCapacity SeatCapacity?   // 座位數量等級
  noiseLevel         NoiseLevel?  // 環境噪音等級

  // --- 吸菸相關 ---
  hasSmokingArea  Boolean?     // 是否有吸菸區
  smokingAreaType SmokingAreaType? // 吸菸區類型
  cigaratteType CigaratteType[]  // 可吸菸種類

  // --- 消費與規範 ---
  minConsumption    String?      // 例如: "一杯飲品" 或 "200元"
  timeLimitMinutes  Int?         // 0 代表不限時
  isBookingRequired Boolean?     // 是否需要預約
  bookingUrl        String?      // 預約連結

  // --- 關聯 ---
  favoriteBy Favorite[]
  createdAt  DateTime @default(now())
}

type Location {
  lat Float
  lng Float
}

enum BusinessStatus {
CLOSED_PERMANENTLY	
CLOSED_TEMPORARILY	
OPERATIONAL
}

enum SeatCapacity {
  MINIMAL   // 極少座位 (例如：1-5, 適合外帶或個人)
  LIMITED   // 少量座位 (例如：6-15, 小型店面)
  STANDARD  // 一般規模 (例如：16-30, 標準咖啡店)
  GENEROUS  // 空間寬敞 (例如：31+, 適合多人或久坐)
}

enum OutletCoverage {
  EVERY    // 每個位置都有
  MOST     // 多數位置有
  SOME     // 部分位置有
  NONE     // 無
}

enum NoiseLevel {
  SILENT        // 極度安靜 (類似圖書館)
  QUIET         // 輕微背景音 (適合專注)
  MODERATE      // 一般咖啡店音量 (適合討論)
  VIBRANT       // 較為吵雜
}



enum SmokingAreaType {
  INDOOR_SEPARATED // 室內吸菸室 
  INDOOR_TABLE // 座位上可抽(室內)
  OUTDOOR    // 戶外
}

enum CigaratteType {
  TRADITIONAL // 傳統香菸
  ELECTRONIC  // 電子煙
  VAPE  // 電子煙
  OTHER      // 其他類型
}